# 第四章：NumPy基础

可能你还记得，在第一章，我们说过NumPy是Python科学计算中的核心包，它提供了基于数组的计算
和线性代数的支持。
由于NumPy是pandas的支柱，我将会介绍它的基础知识在这一章：在解释了什么是NumPy数组后，
我们将研究什么是矢量化和广播，这两个重要的概念允许你编写简洁的数学代码，你将在pandas
再次找到这两个概念。在这之后，我们将通过学习如何获取和设置数值的值以及解释视图和NumPy
数组副本之间的差异，来了解为什么NumPy为什么会提供称为通用函数的特殊函数，在本章结束
之前。即使我们在本书几乎很少直接用NumPy，了解它的基本也会使得我们在下一章更容易学习
pandas。

## NumPy入门

在本节中，我们将会学习一维和二维NumPy阵列，以及矢量化、广播和普遍函数等技术术语背后
的含义。

### NumPy阵列

要使用嵌套列表进行阵列运算，正如我们在上一章遇到的那样，你必须写某种循环。例如，添加
一个数到一个嵌套的列表中，你可以使用以下嵌套列表推导式（list comprehension）：

In [1]: matrix = [[1,2,3],
		  [4,5,6],
		  [7,8,9]]

In [2]: [[i+i for i in row] for row in matrix]

Out[2]: [[2,3,4], [5,6,7], [8,9,10]]

这不是非常的可读，更重要地是，如果你在一个大阵列执行这个操作，遍历每个元素会变得很慢。
根据你的用例和阵列的大小，使用NumPy而不是Python列表可以使你的计算速度提高几倍到上百倍。
NumPy是通过使用C或Fortran写的代码来实现这种性能的————这些是比Python快多的编译语言。
NumPy阵列是同质数据的N维阵列。同质意着，阵列中的所有元素需要是同一个数据类型。最常见的，
你需要处理的一维、二维浮点数阵列，如图所视：

图 4-1： 一个一维和一个二维NumPy数组。

让我们创建本章中需要使用的一个一维和一个二维阵列。

In[3]: # 第一步，让我们引入NumPy
       import numpy as np

In[4]: # 使用简单列表，构造一维阵列
       array1=np.array([10, 100, 1000.])

In[5]: # 使用嵌套列表，构造二维阵列
       array2=np.array([[1., 2., 3.],
                        [4., 5., 6.]])

**阵列维度**
注意一维、二维阵列的区别是很重要的：
一个一维阵列只有一个轴，因此没有明确的列或行方向。虽然这种行为与VBA中的数组很像，
但如果你来自MATLAB这样的，一维阵列始终具有列或行方向的语言，你可能要习惯这种行为。

即使一个阵列中除了最后一个元素（浮点型）都是整型，NumPy阵列的同质性迫使阵列的数据
类型为float64，这类型可以容纳所有元素。为了了解阵列的数据类型，需要访问dtype属性：

In[6]:  array1.dtype
Out[6]: dtype('float64')

由于dtype返回的是float64，而不是我们在上一章遇到的float，你可能已经猜到，NumPy使用了它
自己的数据类型，这比Python的数据类型更加细粒度。但这通常不是一个问题，在大多数时间，
Python和NumPy中不同数据类型之间的转换是自动进行的。

如果你需要显式地转换一个NumPy到Python的基础数据类型，只需使用相应的构造函数（稍后，
我将详细介绍如何访问阵列中的元素）:

#### 矢量计算及广播

如果你构造一个标量和一个NumPy阵列的和，NumPy将执行元素感应操作，这意味着你不必自己
循环遍历元素。




