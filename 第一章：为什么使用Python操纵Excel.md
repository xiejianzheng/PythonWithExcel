# 第一章： 为什么使用Python控制Excel？
通常，Excel用户会质疑他们的电子表格工具，当他们遇到限制的时候。
一个典型的例子是当Excel包含了过多的数据和公式，他们会变得很慢，
甚至崩溃。不过在事态恶化前，质疑你的设置是有道理的。
如果你工作在错误会导致财务或声誉损失的关键任务工作簿时，或者
你每天花费几个小时手工更新Excel工作簿，你需要学习如何使用一门编程语言
自动化处理你的流程。

## 适用于Excel的Python

### 标准库和包管理

Python自带了一组丰富的内置功能，由标准库提供。Python社区喜欢说Python自带电池。
不管你是需要解压ZIP文件、读取CSV文件的值，或需要从internet抓取数据，Python的
标准库已经帮你覆盖，并且你可以完成所有的这些，通常使用几行代码。

虽然Python标准库涵盖了大量的功能，但如果你仅依赖标准库，这里依然存在需要
繁琐编程或缓慢的任务。这就是PyPI的用武之地。PyPI是Python Package Index即
Python包索引的缩写，是一个巨型的仓储库，所有人都可以在其中上传开源的Python包
为Python添加额外的功能。

例如，如果你想更容易地从互联网抓取数据，你可以安装Request包来获得一组强大并且
容易使用的命令。为了安装Request包，你需要使用Python的包管理工具pip。
pip是pip installs packages的循环缩写。是pip安装扩展包动词短语的意思。
如果这听起来有一点抽象，不要担心，我将在下一章详细解释这是如何工作的。
当前来说，最重要的是理解为什么包管理器是如此之重要。一个主要原因是，任何一个
合理的Python包都不会仅仅依赖于Python标准库，而且还会依赖于其他托管在pyPI上的
其他开源包。这些依赖可能还会依赖于其他子依赖，于此类推。
pip（python 包安装工具）会递归地检测依赖和子依赖项，下载并安装它们。
pip还会使更新你的包变得容易，因此你可以保持你的依赖是最新的。这使得遵循DRY（
Don't repeat yourself 不要重复你自己）原则会更容易，因为你不需要重新发明或
复制粘贴PyPI上已有的东西。使用pip和PyPI，你有一个坚实的机制来分发和安装这些
依赖，这是Excel传统的add-ins模块缺乏的。

**关于开源**
在这里，我想说一点关于开源，我在这一章中已经用了这个词多次。如果一个软件是在
开源协议下发布的，这意味着它的源代码是可以免费获得的，允许所有人提供新功能，
错误修复和文档。Python本身和几乎所有第三方Python包都是开源的，并且通常由开发
人员在空闲时间维护。这并不总是一个理想状态。如果你有公司是依赖某些包的，那么
你会期望这些包是由专业的程序员持续开发维护的。幸运的是，Python社区已经认识到
有些包太重要了，不能将它们的命运交给几个只能在晚上和周末工作的志愿者。

这就是为什么在2012年，创建了一个非盈利性组织NumFOCUS，用来赞助在科学计算领域
的各种Python包。由NumFOCUS资助的，最流行的Python包是：pandas，NumPy，SciPy，
Matplotlib和Jupyter项目，但今天还支持很多来自其他语言的包，如R，Julia和
JavaScript。虽然有一些大赞助商，但每个人都可以加入作为免费社区成员加入
NumFOCUS。

使用pip（pip installs packages），你可以安装任何软件包。但对Excel用户来说，
最有趣的肯定是科学计算包。在下一节中，让我们来学习更多关于使用Python进行科学
计算的知识。

## 科学计算
Python成功的重要原因是：它是作为一个通用目的编程语言被创造出来的。
科学计算能力后来以第三方包的形式添加进来。这有独特的优势，这iijjjj就是说数据科学家
可以使用和web开发人员一样的语言进行实验和研究。web开发人员可能最终会制造一个
可用于生产的应用围绕计算内核。
能使用同一种语言构造科学应用程序，可以减少摩擦、实现时间、和代价。
像NumPy，SciPy和pandas这样的科学包给我们以非常简洁的方式来解决数学问题。
作为一个例子：让我们来看看一个更著名的金融公式，用于计算投资组合方差，根据
现代投资组合理论：

方差=wTCw

w是单个资产的权重向量，C是投资组合的协调方差矩阵。
如果w和C是Excel的ranges类型。
那计算投资组合方差在VBA中是这样的：

  variance=Application.MMult(Application.MMult(Application.Transpose(w),C), w);

将其与Python中几乎数学化的表达方式做对比，假设w和C是pandas数据帧或NumPy数组（
我将在第二部分正式介绍它们）：

  variance=w.T @ C @ w

但这不仅仅是关于美学和可读性，NumPy和pandas在内部是使用编译过的Fortran和C代码
实现的，与VBA相比，在处理大型矩阵时，会提高性能。


